## 정규화

- 제1정규화
  - 속성(attr)의 원자성 확보
  - 다중값 속성 분리
  - 기본키 설정
- 제2정규화
  - 부분 함수 종속성
  - 기본키가 2개 이상의 컬럼으로 이루어진 경우
  - (계좌번호, 회원ID) -> 이름
  - (회원ID) -> 이름
  - 이 때 회원ID -> 이름을 분리해야 함.
- 제3정규화
  - 이행 함수 종속성
  - 기본키를 제외한 칼럼 간 종속성 발생
  - (계좌번호, 회원ID) -> (계좌명, 예수금, 관리점코드, 관리점)
  - 관리점코드 -> 관리점
  - 기본키가 아닌 칼럼끼리 종속성이 발생
  - 관리점코드 -> 관리점을 하나의 테이블로 분리
- BCNF
  - 복수의 후보키가 있고, 후보키가 2개 이상의 복합 속성으로 구성되어있으며, 서로 중첩되어야 함
  - (학번, 과목번호) -> 교수
  - 교수 -> 과목번호가 종속. 이 테이블을 분리.

## 정규화의 성능

- join이 많이 발생 -> 성능 저하
- Nested loop가 발생할 수 있음

- 반정규화
  - 정규화했을 때 속도가 많이 느려지는 경우
  - 다량의 범위를 자주 처리해야 하는 경우
- 클러스터링

  - 클러스터링 인덱스: 인덱스 정보를 물리적으로 정렬해서 저장
  - 조회 시에 인접 블록을 연속해서 읽으므로 빨라짐

- 반정규화 기법
  1. 계산된 칼럼 추가
  2. 테이블 수직 분할
     (key, c1, c2, c3, c4, c5, c6)의 경우 (key, c1, c2, c3), (key, c4, c5, c6)으로 나누자
  3. 테이블 수평 분할
     값을 기준으로 분할하자. ex) 2010~2019, 2020~ 이런식으로
     - 파티션 기법
       - 논리적으로는 하나의 테이블이지만 여러 개의 파일에 분할해서 저장
       - range partition: 범위를 기준으로
       - list partition: 특정 값을 기준으로
       - hash partition: 해시함수 사용
       - composite partition: 범위 + 해시
       - 장점
         - 데이터 조회 시 범위가 줄어들어 성능 향상
         - IO 성능 굿
         - 파티션을 독립적으로 백업/복구 가능
  4. 테이블 병합
  - 1대1 테이블을 하나로 병합
  - 1대N 테이블을 병합. 이럴 경우 중복 많이 발생해서 빡셈
  - 슈퍼/서브타입 -> 테이블 병합
    - oneToOne: 그냥 슈퍼서브 다 테이블 각자 만들어줌
    - plus: super+sub1, super+sub2, super+sub3..
    - single: 싱글테이블

## 관계와 조인의 이해

- 셀프 조인
  - 계층형 구조를 표현할 때 사용
  - 사원 테이블이 대표적
    - 관리자(MGR) 컬럼은 사원 테이블의 값을 받음

## 모델이 표현하는 트랜잭션의 이해

- 식별 관계
  - 핵심은 고객 엔티티의 PK가 계좌 엔티티의 PK에 포함되어있다는 것.
  - 고객-계좌 엔티티를 생각해보자
  - 고객은 강한 개체. 혼자 존재 가능
  - 계좌는 약한 개체. 고객에 종속
  - 고객의 기본 키로 계좌 역시 관리 가능
- 비식별 관계
  - 부서-사원
  - 각자 PK를 가지고 있음
  - 강한 개체의 기본키를 일반 칼럼으로 가지고 있음. (그냥 자주 쓰는 FK처럼)
  - 약한 개체는 개체의 존재가 다른 엔티티에 달려 있는 경우. ex) 계좌-계좌입금

## NULL

- NULL과 연산하면 항상 NULL
- NVL 써서 0으로 대체하든 뭐 하든 해야 함
- 집계함수는 NULL 값을 제외한다.
- count(~~) <- NULL을 포함한 행 제외
- 단, count(\*)는 NULL 행도 포함한다.

## 본질 식별자와 인조 식별자

- 본질 식별자는 모델링 도중 업무에서 발생하거나 자연스러운 특성을 이용한 값
  - 주민번호, 상품코드
- 인조 식별자는 인위적으로 만든 고유한 식별번호
  - 카드번호, 사원번호
  - Oracle의 sequence를 사용하여 만들 수 있음
  - `select t_seq.nextval from dual;`
